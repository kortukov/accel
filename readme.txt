3 скрипта для разметки данных

Во всех скриптах чтобы они заработали на другом компьютере достаточно прописать пути к папкам с файлами. В моём случае сами скрипты лежали в папке /home/evgeny/lab/task, .ann и video_data.mat лежали в соседних папках ann и clean_data.

hustle_labels.m добавляет к clean_data файлам вектор с hustle_timing с кадрами метаний с помощью txt файлов из папки hustle_01. Время метаний получается если написать timing[hustle_timing]. За кадр с метанием взят первый, отстоящий меньше чем на 0.05 секунды. Между кадрами там 0.033 секунды, но я взял такое число. Можно и чуть поменьше, хотя мне кажется это не принципиально для разметки.

synchro.m синхронизирует стимулы и реакции с ээг и с камеры. А именно, добавляет к clean_data файлам векторы st_timing и rs_timing длины (число эпох) c помощью ann файлов из папки ann. Алгоритм синхронизации взят простой: проверяем, совпадает ли количество стимулов, если нет - заносим файл в corrupt_files.mat. Если совпадает, считаем вектор разницы между стимулами, прибавляем его к стимулам и реакциям с ээг. Получаем стимулы и реакции во времени рассчитанном камерой. 
Попутно этот скрипт проверяет отсутсвтие реакций и заносит в video_data файл вектор no_reaction_epochs с номерами эпох которые анализировать не надо.

testing1.m это второй вариант алгоритма синхронизации. Он ещё не дописан. Он падает если отсутствует реакция(надо допилить внутрь кусочек, это проверяющий, из synchro.m). Идея алгоритма - рассчитываем расстояние между всеми стимулами на ээг, умножаем на (30/1000) - отношение частот дискретизации, и получаем расстояние между стимулами на видео, в кадрах. Далее надо с помощью первого стимула с камеры и этих расстояний получаем вектор стимулов на видео. То же самое с реакциями. Этот алгоритм должен быть абсолютно устойчив там где на камере выпадали стимулы, НО пока он работает неправильно. Почему-то копится ошибка и последние пересчитаные стимулы съезжают. Видимо, что-то неправильно с формулой или с округлениями.

final_labels.m собирает итоговый вектор разметки по эпохам для всех размеченных файлов, собирает он его из трёх векторов - st_timing, rs_timing, hustle_timing
В нём есть строчка hustle_timing = transpose(timing(hustle_timing)); Прошу меня за неё простить, это надо было сделать в файле hustle_labels :)


synchro.m в процессе работы будет ругаться при чтении .ann файлов. Их надо исправить предварительно руками. Вот такие ошибки я нашёл, возможно есть ещё:
krivosheeva_1 после конца мусор
manuhina_1 мусор
popova_7 нет последнего 255
shilenina_0  мусор
tarasova_6 мусор
